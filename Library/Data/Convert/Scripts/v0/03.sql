CREATE TABLE AppUsers (
  ID BIGINT IDENTITY(1,1) PRIMARY KEY,
  USERNAME VARCHAR(128) NOT NULL,
  SURNAME VARCHAR(128) NOT NULL,
  DEPARTMENT VARCHAR(64),
  EMAIL VARCHAR(256) UNIQUE,
  PHONENUMBER VARCHAR(20),
  PASSWORDHASH VARCHAR(256) NOT NULL,
  SEX CHAR(1) CHECK (SEX IN ('M', 'F')), 
  ADDRESS VARCHAR(256),
  IDCOUNTRY INT,
  FOREIGN KEY (COUNTRY) REFERENCES HBCOUNTRY(ID) ON DELETE SET NULL
);
--убрать подчеркивание
CREATE TABLE HBCOUNTRY (
  ID INT IDENTITY(1,1) PRIMARY KEY,
  NAMECOUNTRY VARCHAR(256) NOT NULL
);
--это в bookservice или в отдельный класс
CREATE TABLE HBAUTHOR (
  ID INT IDENTITY(1,1) PRIMARY KEY,
  NAME VARCHAR(256) NOT NULL
);

CREATE TABLE HBGENRE (
  ID INT IDENTITY(1,1)  PRIMARY KEY,
  NAMEGENRE VARCHAR(256) NOT NULL
);
CREATE TABLE BOOK (
  ID INT IDENTITY(1,1)  PRIMARY KEY,
  NAME VARCHAR(256) NOT NULL,
  PHOTO VARBINARY(MAX),
  DATERELEASE DATE,
  SUMMARY TEXT,
  LANGUAGE VARCHAR(128),
  IDEXTERNAL INT(256)
);

CREATE TABLE HBBOOKSTATUS (
  ID INT IDENTITY(1,1) PRIMARY KEY ,
  NAMESTATUS VARCHAR(256) NOT NULL
);
CREATE TABLE AUTHORSBOOKS (
  IDAUTHOR INT NOT NULL,
  IDBOOK INT NOT NULL,
  PRIMARY KEY (IDAUTHOR, IDBOOK),
  FOREIGN KEY (IDAUTHOR) REFERENCES HBAUTHOR(ID) ON DELETE CASCADE,
  FOREIGN KEY (IDBOOK) REFERENCES BOOK(ID) ON DELETE CASCADE
);
CREATE TABLE BOOKGENRES (
  IDBOOK INT NOT NULL,
  IDGENRE INT NOT NULL,
  PRIMARY KEY (IDBOOK, IDGENRE),
  FOREIGN KEY (IDBOOK) REFERENCES BOOK(ID) ON DELETE CASCADE,
  FOREIGN KEY (IDGENRE) REFERENCES HBGENRE(ID) ON DELETE CASCADE
);

CREATE TABLE INVENTORY (
  ID INT IDENTITY(1,1) PRIMARY KEY,
  IDBOOK INT NOT NULL,
  NAMELIBRARY VARCHAR(128),
  LIBRARYROOM VARCHAR(256),
  FOREIGN KEY (IDBOOK) REFERENCES BOOK(ID) ON DELETE CASCADE
);

CREATE TABLE LOGINVENTORY (
  ID INT IDENTITY(1,1) PRIMARY KEY,
  IDUSER BIGINT,
  STARTDATE SMALLDATETIME,
  ENDDATE SMALLDATETIME,
  IDSTATUS INT,
  FOREIGN KEY (IDUSER) REFERENCES AppUsers(ID) ON DELETE CASCADE,
  FOREIGN KEY (IDSTATUS) REFERENCES HBBOOKSTATUS(ID) ON DELETE SET NULL
);
